from scipy import interpolate
import numpy as np
#FIXME: missing vcma and write 

J_lut = np.linspace(-6e9,6e9,41)

energy_avg_she = [1.69582669e-13, 1.67630107e-13, 1.65783163e-13, 1.64035376e-13,
 1.62381433e-13, 1.60831510e-13, 1.59382467e-13, 1.58028616e-13,
 1.56772018e-13, 1.55617286e-13, 1.54556390e-13, 1.53590236e-13,
 1.52716905e-13, 1.51939687e-13, 1.51255043e-13, 1.50664055e-13,
 1.50171533e-13, 1.49778345e-13, 1.49489403e-13, 1.49311076e-13,
 1.49250377e-13, 1.49313588e-13, 1.49509741e-13, 1.49845709e-13,
 1.50328625e-13, 1.50963939e-13, 1.51758886e-13, 1.52711291e-13,
 1.53831460e-13, 1.55115592e-13, 1.56563750e-13, 1.58172363e-13,
 1.59953033e-13, 1.61896167e-13, 1.63999656e-13, 1.66261254e-13,
 1.68691930e-13, 1.71276488e-13, 1.74027941e-13, 1.76940064e-13,
 1.80010079e-13]

bit_avg_she = [9.99105e-01, 9.98360e-01, 9.97475e-01, 9.96170e-01, 9.93635e-01, 9.89935e-01,
    9.84885e-01, 9.78295e-01, 9.68750e-01, 9.56170e-01, 9.39425e-01, 9.20085e-01,
    8.92535e-01, 8.60480e-01, 8.21865e-01, 7.78710e-01, 7.33545e-01, 6.78290e-01,
    6.21895e-01, 5.62025e-01, 5.01395e-01, 4.39310e-01, 3.79450e-01, 3.22725e-01,
    2.69530e-01, 2.17580e-01, 1.76170e-01, 1.38400e-01, 1.07065e-01, 8.08900e-02,
    5.98750e-02, 4.41350e-02, 3.16700e-02, 2.22750e-02, 1.47200e-02, 9.44500e-03,
    6.08000e-03, 4.18500e-03, 2.45000e-03, 1.64500e-03, 9.20000e-04]

def jz_lut_she(weight):
    if weight > 0.9988:
        return -6.6e9
    elif weight < 0.002:
        return 6.6e9
    else:
        f = interpolate.interp1d(bit_avg_she, J_lut)
        return f(weight)

def energy_she(weight):
    if weight > 0.9988:
        return 1.9e-13
    elif weight < 0.002:
        return 1.9e-13
    else:
        f = interpolate.interp1d(bit_avg_she, energy_avg_she)
        return f(weight)
