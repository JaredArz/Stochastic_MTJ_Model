from scipy import interpolate
import numpy as np

J_lut = np.linspace(-6e9,6e9,41)

bit_avg_she = [9.99105e-01, 9.98360e-01, 9.97475e-01, 9.96170e-01, 9.93635e-01, 9.89935e-01,
    9.84885e-01, 9.78295e-01, 9.68750e-01, 9.56170e-01, 9.39425e-01, 9.20085e-01,
    8.92535e-01, 8.60480e-01, 8.21865e-01, 7.78710e-01, 7.33545e-01, 6.78290e-01,
    6.21895e-01, 5.62025e-01, 5.01395e-01, 4.39310e-01, 3.79450e-01, 3.22725e-01,
    2.69530e-01, 2.17580e-01, 1.76170e-01, 1.38400e-01, 1.07065e-01, 8.08900e-02,
    5.98750e-02, 4.41350e-02, 3.16700e-02, 2.22750e-02, 1.47200e-02, 9.44500e-03,
    6.08000e-03, 4.18500e-03, 2.45000e-03, 1.64500e-03, 9.20000e-04]

energy_avg_she = [1.69582669e-13, 1.67630107e-13, 1.65783163e-13, 1.64035376e-13,
 1.62381433e-13, 1.60831510e-13, 1.59382467e-13, 1.58028616e-13,
 1.56772018e-13, 1.55617286e-13, 1.54556390e-13, 1.53590236e-13,
 1.52716905e-13, 1.51939687e-13, 1.51255043e-13, 1.50664055e-13,
 1.50171533e-13, 1.49778345e-13, 1.49489403e-13, 1.49311076e-13,
 1.49250377e-13, 1.49313588e-13, 1.49509741e-13, 1.49845709e-13,
 1.50328625e-13, 1.50963939e-13, 1.51758886e-13, 1.52711291e-13,
 1.53831460e-13, 1.55115592e-13, 1.56563750e-13, 1.58172363e-13,
 1.59953033e-13, 1.61896167e-13, 1.63999656e-13, 1.66261254e-13,
 1.68691930e-13, 1.71276488e-13, 1.74027941e-13, 1.76940064e-13,
 1.80010079e-13]

bit_avg_vcma = [0.999995, 0.999995, 0.9999750000000001, 0.9999350000000001, 0.9998500000000001, 0.9996750000000002,
 0.9993200000000002, 0.998575, 0.9967399999999997, 0.9941299999999998, 0.988425, 0.9793549999999998,
 0.96523, 0.9438449999999999, 0.912645, 0.8703350000000001, 0.8189249999999999, 0.75329, 0.6735649999999999,
 0.589635, 0.49924999999999997, 0.41176499999999994, 0.323015, 0.24708999999999998, 0.182275, 0.13015, 0.085885,
 0.056255, 0.03487, 0.020659999999999998, 0.0113, 0.0060750000000000005, 0.00306, 0.0016149999999999997,
 0.0007500000000000002, 0.00033, 9.5e-05, 7.500000000000001e-05, 3.0000000000000004e-05, 5e-06, 5e-06]

energy_avg_vcma = [4.5654204712453536e-14, 4.125670410882806e-14, 3.7081107799407894e-14, 3.3124924289176136e-14,
 2.9390367856257544e-14, 2.5876077933948243e-14, 2.258291882979718e-14, 1.9512614562139135e-14,
 1.6665674835557327e-14, 1.4041133398856185e-14, 1.164431303062378e-14, 9.471623714676163e-15,
 7.522196947267414e-15, 5.797851586480901e-15, 4.295560814175367e-15, 3.0145502817264004e-15,
 1.9527521137148794e-15, 1.1144919644677391e-15, 5.037392267569622e-16, 1.2817276512859494e-16,
 2.6051105875747128e-24, 1.3295762190970325e-16, 5.418380880731363e-16, 1.2393503253338154e-15,
 2.2362526706721725e-15, 3.5391832664729566e-15, 5.156304498604529e-15, 7.082359278824152e-15,
 9.322291741061216e-15, 1.1872660183398066e-14, 1.4736741271475984e-14, 1.7907668063384043e-14,
 2.1389620172930623e-14, 2.5183402126243404e-14, 2.929091159163603e-14, 3.371176554769616e-14,
 3.844943044724978e-14, 4.349935434215015e-14, 4.886665745718449e-14, 5.4548934231674445e-14, 6.054921294525308e-14]

Jwrite = np.linspace(0,3e11,41)
bit_avg_write = [0.979875, 0.977225, 0.9735849999999999, 0.9698399999999999, 0.9654999999999999, 0.9605649999999999, 0.954815,
 0.94697, 0.9391650000000002, 0.9303600000000001, 0.9185149999999999, 0.9065700000000001, 0.8906500000000002,
 0.87361, 0.8545900000000002, 0.8297749999999999, 0.803835, 0.7699650000000001, 0.7346600000000001, 0.6926299999999999,
 0.6427750000000001, 0.588795, 0.53108, 0.4626850000000001, 0.39076, 0.31675000000000003, 0.242, 0.173705, 0.11474999999999999,
 0.06808, 0.034885000000000006, 0.01567, 0.0057599999999999995, 0.0018850000000000006, 0.00049, 9.000000000000002e-05,
 0.0, 0.0, 5e-06, 5e-06, 0.0]
energy_avg_write = [1.0603730202608104e-10, 1.0593354520541111e-10, 1.0583595825192778e-10, 1.0574132602719777e-10, 1.0565310061654008e-10,
 1.0556066445482902e-10, 1.0547854408966826e-10, 1.0539988665302786e-10, 1.0532757150676085e-10, 1.0525106989789366e-10,
 1.0518998287072088e-10, 1.0512997386375595e-10, 1.050793789673585e-10, 1.0503470717626584e-10, 1.0499512524558136e-10,
 1.049710517152941e-10, 1.0495101800154366e-10, 1.0495078264095848e-10, 1.0495390880237156e-10, 1.049744577090797e-10,
 1.0501427207095657e-10, 1.0505804380129411e-10, 1.0511476758616467e-10, 1.0519215177067638e-10, 1.0527475330004284e-10,
 1.0536238771063911e-10, 1.0545057283796456e-10, 1.0552303756128367e-10, 1.0557837468703338e-10, 1.056108446857024e-10,
 1.056213430619679e-10, 1.0561134882330208e-10, 1.0558960694202063e-10, 1.0556243831887083e-10, 1.055359803018782e-10,
 1.0551231669223002e-10, 1.0549247199793941e-10, 1.0547686509945751e-10, 1.0546574580983654e-10, 1.0545901389272944e-10, 1.0545674378248382e-10]

def jz_lut_she(weight):
    if weight > 0.9988:
        return -6.6e9
    elif weight < 0.002:
        return 6.6e9
    else:
        f = interpolate.interp1d(bit_avg_she, J_lut)
        return f(weight)

def energy_she(weight):
    if weight > 0.9988:
        return 1.9e-13
    elif weight < 0.002:
        return 1.9e-13
    else:
        f = interpolate.interp1d(bit_avg_she, energy_avg_she)
        return f(weight)

def jz_lut_vcma(weight):
    f = interpolate.interp1d(bit_avg_vcma, J_lut)
    return f(weight)

def energy_vcma(weight):
    f = interpolate.interp1d(bit_avg_vcma, energy_avg_vcma)
    return f(weight)

def jz_lut_write(weight):
    if weight > 0.988:
        return -4e11
    else:
        f = interpolate.interp1d(bit_avg_write, Jwrite)
        return -f(weight)

        return f(weight)

def energy_write(weight):
    if weight > 0.988:
        return 3.4e-12
    else:
        f = interpolate.interp1d(bit_avg_write, energy_avg_write)
        return f(weight)
